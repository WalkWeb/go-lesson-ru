
# Изучаем язык Go #74 – HTTP-клиенты (http-запросы)

Довольно часто в работе нужно сделать запрос к какому-то внешнему сервису по http, и обработать ответ. В этом уроке мы
рассмотрим как это сделать.

Для http запросов в Golang есть встроенная библиотека `net/http`

HTTP-запрос (будем делать простой с методом GET – получающий содержимое) делается одной строкой. Запрос будет сделан с 
помощью `http.DefaultClient`:

```go
response, err := http.Get("https://example.com/")
```

Разумеется, после запроса нужно проверить, не было ли ошибки (например, внешний сайт может быть недоступен). И если
была ошибка – завершить работу:

```go
    if err != nil {
        panic(err)
    }
```

А затем закрыть соединение.

```go
    defer response.Body.Close()
```

Два самых важных параметра в http-ответе, это код ответа (по нему можно понять, прошел ли запрос успешно или произошла
ошибка, читайте подробнее об [http кодах ответа](https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%BA%D0%BE%D0%B4%D0%BE%D0%B2_%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F_HTTP))
и тело ответа.

Получаем код ответа:

```go
    fmt.Println("Response status code:", response.Status)
```

Тело ответа – это строка. И если это html-страницы – то строка будет большого размера. Для примера распечатаем лишь 
первые 4 строки:

```go
    scanner := bufio.NewScanner(response.Body)

    for i := 0; scanner.Scan() && i < 4; i++ {
        fmt.Println(scanner.Text())
    }
```

И в завершение проверяем, не было ли ошибок в сканере:

```go
    if err := scanner.Err(); err != nil {
        panic(err)
    }
```

Выполнив код получим:

```
$ go run http-client.go 
Response status code: 200 OK
<!doctype html>
<html>
<head>
    <title>Example Domain</title>
```

Таким способом мы сделали http-запрос к внешнему сайту и узнали код и тело ответа.
____

В этом уроке вы узнали:

- Как сделать http-запрос и узнать код и содержимое ответа

Читайте также:

- [Официальную документацию по пакету net/http](https://pkg.go.dev/net/http)
